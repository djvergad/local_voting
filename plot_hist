#!/usr/bin/gnuplot
#set term postscript enhanced color 
set term postscript eps enhanced color size 4,2.8 linewidth 2 font 'Helvetica,17pt'
#set terminal epslatex color

#set size 1,1
#set key spacing 1.5
#set boxwidth 0.85

set pointsize 1.5
set key spacing 1.5 maxrows 3 opaque width -5


set out "figures/simple_hist.eps"
set title "steady state - histgram - individual"
set boxwidth 0.05 absolute
set style fill solid 1.0 noborder
set xlabel "Queue length"
set ylabel "Points"
#set yrange [0:10000]
set xrange [1:*]
set yrange [0.001:*]
set logscale x
set logscale y

# bin_width = 1;
# bin_number(x) = 10**floor(log10(x+0.1)/bin_width)


bin_width = 1.3

rounded(x) = bin_width**(floor(log(x+0.1)/log(bin_width)))       # bin_width * (bin_number(x) + 0.5)

val(x,y) = (x*1.0) / rounded(y)

do for [k=1:100] {
   print k, log(k), ceil(log(k)), rounded(k) , val(5,k)
}

set style histogram clustered
set boxwidth 0.01

# plot 'hist_localvoting_scen2' using (rounded($1)):(1) smooth frequency t "Local Voting"

plot "<awk '/Dumping Slots:/{p=0}p{print $1,$2};/Dumping Queue:/{p=1}' output_hist_100_10_100_10_0.001_LocalVoting_0.0_1_true"  using (rounded($1)):(val($2,$1)) smooth frequency t "Local Voting" w l, \
     "<awk '/Dumping Queue:/,/Dumping Slots:/' output_hist_100_10_100_10_0.001_LQF_0.0_1_true" using (rounded($1)):(val($2,$1)) ti 'LQF' smooth freq w l, \
     "<awk '/Dumping Queue:/,/Dumping Slots:/' output_hist_100_10_100_10_0.001_DRAND_0.0_1_true" using (rounded($1)):(val($2,$1)) ti 'DRAND' smooth freq w l
     



# set out "figures/avg.eps"
# set title "steady state - histgram - average over time"
# bin_width = 0.01;
# set ylabel "Nodes"
# set yrange [*:*]
# set xrange [0:0.7]
# plot 'single_dump_simple_avg' using (rounded($1)):(1) smooth frequency t "simple", \
#      'single_dump_balanced_avg' using (rounded($1)):(1) smooth frequency t "balanced", \
#      'single_dump_localVoting_avg' using (rounded($1)):(1) smooth frequency t "Local Voting"

